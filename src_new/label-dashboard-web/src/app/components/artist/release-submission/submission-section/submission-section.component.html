<div class="submission-section">
  <h4>Release Summary</h4>

  <!-- Release Information Summary - Full Width -->
  <div class="card mb-4" *ngIf="releaseInfoData">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Release Information</h5>
      <button type="button" class="btn btn-sm btn-outline-primary" (click)="onNavigateToSection('info')">
        <i class="fa fa-edit me-1"></i>Edit
      </button>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <p><strong>Title:</strong> {{ releaseInfoData.title || 'Not specified' }}</p>
          <p><strong>Catalog Number:</strong> {{ releaseInfoData.catalog_no || 'Not specified' }}</p>
          <p><strong>UPC:</strong> {{ releaseInfoData.UPC || 'Not specified' }}</p>
        </div>
        <div class="col-md-6">
          <p><strong>Release Date:</strong> {{ formatDate(releaseInfoData.release_date) || 'Not specified' }}</p>
          <p><strong>Cover Art:</strong>
            <span *ngIf="releaseInfoData.cover_art_preview || releaseInfoData.cover_art"> âœ“ Uploaded</span>
            <span *ngIf="!releaseInfoData.cover_art_preview && !releaseInfoData.cover_art" class="text-warning"> Not uploaded</span>
          </p>
        </div>
      </div>

      <div class="mt-3" *ngIf="releaseInfoData.description">
        <strong>Description:</strong>
        <div class="mt-1" [innerHTML]="releaseInfoData.description"></div>
      </div>

      <div class="mt-3" *ngIf="albumCreditsData?.liner_notes">
        <strong>Liner Notes:</strong>
        <div class="mt-1" [innerHTML]="albumCreditsData!.liner_notes"></div>
      </div>
    </div>
  </div>

  <!-- Album Credits Summary - Full Width -->
  <div class="card mb-4" *ngIf="albumCreditsData">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Album Credits</h5>
      <button type="button" class="btn btn-sm btn-outline-primary" (click)="onNavigateToSection('credits')">
        <i class="fa fa-edit me-1"></i>Edit
      </button>
    </div>
    <div class="card-body">
      <div *ngIf="albumCreditsData.artists && albumCreditsData.artists.length > 0">
        <h6>Artists & Royalties</h6>

        <!-- Admin view: detailed table with percentages -->
        <div *ngIf="isAdmin" class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr>
                <th>Artist</th>
                <th>Streaming</th>
                <th>Download</th>
                <th>Physical</th>
                <th>Sync</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let artist of albumCreditsData.artists">
                <td>{{ artist.name || 'Unknown Artist' }}</td>
                <td>{{ artist.streaming_royalty_percentage || 0 }}%</td>
                <td>{{ artist.download_royalty_percentage || 0 }}%</td>
                <td>{{ artist.physical_royalty_percentage || 0 }}%</td>
                <td>{{ artist.sync_royalty_percentage || 0 }}%</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Non-admin view: simple list -->
        <div *ngIf="!isAdmin">
          <div class="row">
            <div class="col-md-12">
              <p class="mb-2"><strong>Artists:</strong></p>
              <ul class="list-unstyled">
                <li *ngFor="let artist of albumCreditsData.artists" class="mb-1">
                  <i class="fa fa-user me-2"></i>{{ artist.artist_name || artist.name || 'Unknown Artist' }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-3" *ngIf="albumCreditsData.liner_notes">
        <strong>Liner Notes:</strong>
        <div class="mt-1" [innerHTML]="albumCreditsData.liner_notes"></div>
      </div>

      <div *ngIf="!albumCreditsData.artists || albumCreditsData.artists.length === 0" class="text-center text-muted py-3">
        <i class="fa fa-users fa-2x mb-2"></i>
        <p>No artists added yet</p>
      </div>
    </div>
  </div>

  <!-- Track List Summary - Full Width -->
  <div class="card mb-4" *ngIf="trackListData">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Track List ({{ trackListData.songs?.length || 0 }} tracks)</h5>
      <button type="button" class="btn btn-sm btn-outline-primary" (click)="onNavigateToSection('tracks')">
        <i class="fa fa-edit me-1"></i>Edit
      </button>
    </div>
    <div class="card-body">
      <div *ngIf="trackListData.songs && trackListData.songs.length > 0">
        <div class="track-summary" *ngFor="let song of trackListData.songs; let i = index">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ i + 1 }}. {{ song.title || 'Untitled' }}</strong>
              <span class="text-muted ms-2" *ngIf="song.duration">({{ Math.floor(song.duration / 60) }}:{{ (song.duration % 60).toString().padStart(2, '0') }})</span>
            </div>
            <div>
              <span class="badge text-white" [style.background-color]="song.audio_file ? '#28a745' : '#ffc107'">
                <i class="fa" [class]="song.audio_file ? 'fa-check' : 'fa-exclamation-triangle'"></i>
                {{ song.audio_file ? 'Audio uploaded' : 'No audio' }}
              </span>
            </div>
          </div>
          <div class="text-muted small mt-1" *ngIf="song.collaborators && song.collaborators.length > 0">
            Featuring: {{ getCollaboratorNames(song) }}
          </div>
        </div>
      </div>

      <div *ngIf="!trackListData.songs || trackListData.songs.length === 0" class="text-center text-muted py-3">
        <i class="fa fa-music fa-2x mb-2"></i>
        <p>No tracks added yet</p>
      </div>
    </div>
  </div>

  <!-- Bottom Section: Validation and Submit -->
  <div class="row">
    <div class="col-md-6">
      <!-- Validation Summary -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Validation Summary</h5>
        </div>
        <div class="card-body">
          <!-- Errors -->
          <div *ngIf="allErrors.length > 0" class="alert alert-danger mb-3">
            <div class="d-flex align-items-center mb-2">
              <i class="fa fa-exclamation-circle me-2"></i>
              <strong>{{ allErrors.length }} error{{ allErrors.length !== 1 ? 's' : '' }} found</strong>
            </div>
            <ul class="mb-0 small">
              <li *ngFor="let error of allErrors">{{ error }}</li>
            </ul>
          </div>

          <!-- Warnings -->
          <div *ngIf="allWarnings.length > 0" class="alert alert-warning mb-3">
            <div class="d-flex align-items-center mb-2">
              <i class="fa fa-exclamation-triangle me-2"></i>
              <strong>{{ allWarnings.length }} warning{{ allWarnings.length !== 1 ? 's' : '' }}</strong>
            </div>
            <ul class="mb-0 small">
              <li *ngFor="let warning of allWarnings">{{ warning }}</li>
            </ul>
          </div>

          <!-- Success -->
          <div *ngIf="allErrors.length === 0 && allWarnings.length === 0" class="alert alert-success mb-0">
            <i class="fa fa-check-circle me-2"></i>
            <strong>All validations passed!</strong>
            <div class="small mt-1">Ready for submission</div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <!-- Submission Warning -->
      <div class="alert alert-warning mb-4">
        <i class="fa fa-exclamation-triangle me-2"></i>
        <strong>Important:</strong> Once submitted, this release will be sent for processing and distribution.
        Make sure all information is correct and complete.

        <!-- Acknowledgment Checkbox - Only show when no errors -->
        <div *ngIf="allErrors.length === 0" class="form-check mt-3">
          <input
            class="form-check-input"
            type="checkbox"
            id="acknowledgeSubmission"
            [(ngModel)]="hasAcknowledged">
          <label class="form-check-label" for="acknowledgeSubmission">
            <strong>I understand and wish to proceed</strong>
          </label>
        </div>
      </div>

      <!-- Submit Button -->
      <button
        type="button"
        class="btn btn-primary btn-lg btn-block submit-release-btn"
        style="font-size: 1.25rem; padding: 1rem 2rem; font-weight: 600; box-shadow: 0 4px 8px rgba(0,0,0,0.1);"
        [disabled]="allErrors.length > 0 || isSubmitting || !hasAcknowledged"
        (click)="onSubmit()">
        <i class="fa fa-2x me-3" [class]="isSubmitting ? 'fa-spinner fa-spin' : 'fa-paper-plane'" style="vertical-align: middle;"></i>
        <span style="vertical-align: middle;">{{ isSubmitting ? 'Submitting...' : 'Submit Release' }}</span>
      </button>

      <div *ngIf="allErrors.length > 0" class="text-center mt-2">
        <small class="text-danger">
          <i class="fa fa-exclamation-circle me-1"></i>
          Please fix all errors before submitting
        </small>
      </div>

      <div *ngIf="allErrors.length === 0 && !hasAcknowledged" class="text-center mt-2">
        <small class="text-muted">
          <i class="fa fa-info-circle me-1"></i>
          Please check the acknowledgment box to enable submission
        </small>
      </div>

      <div *ngIf="allErrors.length === 0 && hasAcknowledged && allWarnings.length > 0" class="text-center mt-2">
        <small class="text-warning">
          <i class="fa fa-exclamation-triangle me-1"></i>
          Warnings detected - you can still submit, but consider addressing them first
        </small>
      </div>
    </div>
  </div>
</div>