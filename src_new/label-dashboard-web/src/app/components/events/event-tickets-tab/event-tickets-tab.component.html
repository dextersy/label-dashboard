<div class="event-tickets-tab">
  <!-- Paginated Table -->
  <app-paginated-table
    title=""
    [data]="tickets"
    [pagination]="pagination"
    [loading]="loading"
    [columns]="tableColumns"
    [showSearch]="true"
    [showSortableHeaders]="true"
    [sortInfo]="currentSort"
    [showActionsColumn]="isAdmin"
    (pageChange)="onPageChange($event)"
    (filtersChange)="onFiltersChange($event)"
    (sortChange)="onSortChange($event)">
    
    <!-- Custom buttons template -->
    <ng-template #customButtons>
      <button 
        class="btn btn-sm btn-outline-primary" 
        (click)="onDownloadCSV()"
        *ngIf="isAdmin"
        [disabled]="loading">
        <i class="fa fa-download me-1"></i>
        Download CSV
      </button>
    </ng-template>
    
    <!-- Actions template -->
    <ng-template #actionsContent let-ticket>
      <div class="btn-group" role="group">
        <button 
          class="btn btn-sm btn-outline-primary"
          (click)="onResendTicket(ticket.id)"
          *ngIf="isTicketResendable(ticket)"
          title="Resend ticket">
          Resend
        </button>
        <button 
          class="btn btn-sm btn-outline-danger"
          (click)="onCancelTicket(ticket.id)"
          *ngIf="isTicketCancellable(ticket)"
          title="Cancel ticket">
          Cancel
        </button>
      </div>
    </ng-template>
  </app-paginated-table>

  <!-- Summary Footer - Matching PHP layout -->
  <div class="card mt-3" *ngIf="summary">
    <div class="card-footer sticky-bottom bg-light">
      <strong>Totals </strong>&nbsp;&nbsp;
      
      <span class="me-3" title="Number of paid tickets">
        <i class="fas fa-dot-circle text-success"></i> 
        {{ summary.total_tickets_sold }}&nbsp;&nbsp;
      </span>
      
      <span class="me-3" title="Total revenue">
        <i class="fas fa-money-bill"></i> 
        {{ (summary.total_revenue | number:'1.2-2') }}&nbsp;&nbsp;
      </span>
      
      <!-- Superadmin-specific stats (matching PHP condition for admin_email env variable) -->
      <span class="text-muted" *ngIf="isSuperadmin()">
        <span class="me-2" title="Total processing fee">
          <i class="fas fa-credit-card"></i> 
          -{{ (summary.total_processing_fee || 0) | number:'1.2-2' }}&nbsp;&nbsp;
        </span>
        
        <span class="me-2" title="Net amount">
          <i class="fas fa-plus"></i> 
          {{ (summary.net_revenue || 0) | number:'1.2-2' }}&nbsp;&nbsp;
        </span>
        
        <span class="me-2" title="Tax">
          <i class="fas fa-percentage"></i> 
          -{{ (summary.tax || 0) | number:'1.2-2' }}&nbsp;&nbsp;
        </span>
        
        <span class="me-3 fw-bold" title="Admin grand total">
          <i class="fas fa-plus-square"></i> 
          <strong>₱{{ (summary.admin_grand_total || 0) | number:'1.2-2' }}</strong>
          &nbsp;&nbsp;&nbsp;
        </span>
      </span>
      
      <span class="me-2" title="Platform fee">
        <i class="fas fa-money-bill"></i> 
        -{{ (summary.platform_fee | number:'1.2-2') }}&nbsp;&nbsp;
      </span>
      
      <span class="fw-bold" title="Grand total">
        <i class="fas fa-plus-square"></i> 
        <strong>₱{{ (summary.grand_total | number:'1.2-2') }}</strong>
      </span>
    </div>
  </div>

  <!-- Info Alert -->
  <div class="alert alert-info mt-3">
    <h6><i class="fa fa-user-plus me-2"></i>Want to invite someone?</h6>
    <p class="mb-0">Switch to the "Pending Tickets" tab to create a custom ticket.</p>
  </div>
</div>