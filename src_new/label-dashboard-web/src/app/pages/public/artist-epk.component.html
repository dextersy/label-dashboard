<div class="artist-epk-page" (keydown)="onKeyDown($event)" tabindex="0">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center" style="min-height: 400px;">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading artist information...</span>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="isError && !isLoading" class="epk-error-state">
    <div class="epk-error-icon">
      <i class="fas fa-music"></i>
    </div>
    <h3 class="epk-error-title">Artist not found</h3>
    <p class="epk-error-message">Sorry, we couldn't find the artist you were looking for.<br>If you think this was a mistake, please <a href="mailto:support@melt-records.com?subject=EPK Page Not Found">contact support</a>.</p>
  </div>

  <!-- EPK Content - Template 1 (Modern Gradient Design) -->
  <div *ngIf="!isLoading && !isError && epkData && getEpkTemplate() === 1" class="epk-content template-1">
    
    <!-- Hero Section -->
    <div class="hero-section" [style.background-image]="'url(' + getProfilePhotoUrl(epkData.artist.profile_photo) + ')'">
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-10 text-center">
              <div class="profile-photo-wrapper">
                <img 
                  [src]="getProfilePhotoUrl(epkData.artist.profile_photo)" 
                  [alt]="epkData.artist.name + ' Profile Photo'"
                  class="hero-profile-photo">
              </div>
              <h1 class="hero-title">{{ epkData.artist.name }}</h1>
              <div *ngIf="epkData.brand" class="hero-label">
                <span class="brand-tag" 
                      [style.color]="getBrandColor()" 
                      [style.background-color]="getBrandTagBackgroundColor()">
                  {{ epkData.brand.name }}
                </span>
              </div>
              
              <!-- Social Media Links -->
              <div *ngIf="getSocialMediaLinks().length > 0" class="hero-social-links">
                <a 
                  *ngFor="let link of getSocialMediaLinks()" 
                  [href]="link.url" 
                  target="_blank" 
                  class="hero-social-link"
                  [title]="link.name">
                  <i [class]="link.icon"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Artist Bio -->
    <div *ngIf="epkData.artist.bio" class="content-section bio-section">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="section-header">
              <h2 class="section-title">About</h2>
            </div>
            <div class="bio-content" [innerHTML]="epkData.artist.bio"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Releases Section -->
    <div *ngIf="epkData.releases.length > 0" class="content-section releases-section">
      <div class="container">
        <div class="section-header text-center">
          <h2 class="section-title">Music</h2>
          <p class="section-subtitle">Latest releases and discography</p>
        </div>
        <div class="releases-grid">
          <div *ngFor="let release of epkData.releases" class="release-item">
            <div class="release-artwork">
              <img 
                [src]="getCoverArtUrl(release.cover_art_url)" 
                [alt]="release.title + ' Cover Art'"
                class="release-image">
              <!-- Coming Soon badge for Pending releases (always visible) -->
              <span *ngIf="release.status === 'Pending'" class="coming-soon-badge">Coming on {{ formatReleaseDate(release.release_date) }}</span>
              <div class="release-overlay">
                <!-- Play/Pause Button for Live Releases with Audio -->
                <button
                  *ngIf="isReleasePlayable(release)"
                  class="play-pause-btn"
                  [class.paused]="isReleasePaused(release)"
                  [class.loading]="isReleaseLoading(release)"
                  [disabled]="isReleaseLoading(release)"
                  (click)="togglePlayRelease(release); $event.stopPropagation()"
                  [attr.aria-label]="isReleaseLoading(release) ? 'Loading' : isReleasePlaying(release) ? 'Pause' : isReleasePaused(release) ? 'Resume' : 'Play'">
                  <i *ngIf="!isReleaseLoading(release)" [class]="isReleasePlaying(release) ? 'fas fa-pause' : 'fas fa-play'"></i>
                  <i *ngIf="isReleaseLoading(release)" class="fas fa-spinner fa-spin"></i>
                </button>
                
                <div class="streaming-icons" *ngIf="getStreamingLinks(release).length > 0">
                  <a 
                    *ngFor="let link of getStreamingLinks(release)" 
                    [href]="link.url" 
                    target="_blank" 
                    class="stream-icon"
                    [title]="link.name">
                    <i [class]="link.icon"></i>
                  </a>
                </div>
              </div>
            </div>
            <div class="release-details">
              <h3 class="release-name">{{ release.title }}</h3>
              <p class="release-meta">{{ formatReleaseDate(release.release_date) }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Media Gallery Section -->
    <div *ngIf="epkData.gallery.length > 0" class="content-section gallery-section">
      <div class="container">
        <div class="section-header text-center">
          <h2 class="section-title">Gallery</h2>
          <p class="section-subtitle">Behind the scenes and live moments</p>
        </div>
        <div class="gallery-grid">
          <div *ngFor="let item of epkData.gallery; let i = index" class="gallery-photo" (click)="openLightbox(i)">
            <img 
              [src]="getGalleryImageUrl(item.image_url)" 
              [alt]="item.caption || 'Gallery Image'"
              class="gallery-img">
            <div class="gallery-hover">
              <div class="gallery-hover-content">
                <i class="fas fa-expand"></i>
                <span *ngIf="item.caption" class="hover-caption">{{ item.caption }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="epk-footer">
      <div class="container">
        <div class="footer-content text-center">
          <div class="footer-branding">
            <p class="powered-by">Powered by <strong>Melt Records Dashboard</strong></p>
          </div>
          <div class="footer-contact">
            <p class="contact-text">
              Need help? <a [href]="'mailto:support@melt-records.com?subject=EPK Support - ' + epkData.artist.name" class="contact-link">Contact us</a>
            </p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- EPK Content - Template 2 (Minimal Clean Design) -->
  <div *ngIf="!isLoading && !isError && epkData && getEpkTemplate() === 2" class="epk-content template-2">

    <!-- Minimal Header -->
    <div class="minimal-header">
      <div class="container">
        <div class="row">
          <div class="col-12 text-center">
            <div class="minimal-profile">
              <img
                [src]="getProfilePhotoUrl(epkData.artist.profile_photo)"
                [alt]="epkData.artist.name + ' Profile Photo'"
                class="minimal-profile-photo">
              <h1 class="minimal-artist-name">{{ epkData.artist.name }}</h1>
              <div *ngIf="epkData.brand" class="minimal-brand-label">
                {{ epkData.brand.name }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Simple Navigation / Social Media -->
    <div *ngIf="getSocialMediaLinks().length > 0" class="minimal-social-section">
      <div class="container">
        <div class="minimal-social-links">
          <a
            *ngFor="let link of getSocialMediaLinks()"
            [href]="link.url"
            target="_blank"
            class="minimal-social-link"
            [title]="link.name">
            <i [class]="link.icon"></i>
            <span class="social-name">{{ link.name }}</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Bio Section -->
    <div *ngIf="epkData.artist.bio" class="minimal-section minimal-bio-section">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8 col-md-10">
            <h2 class="minimal-section-title">About</h2>
            <div class="minimal-bio-content" [innerHTML]="epkData.artist.bio"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Music Section -->
    <div *ngIf="epkData.releases.length > 0" class="minimal-section minimal-music-section">
      <div class="container">
        <h2 class="minimal-section-title text-center">Music</h2>
        <div class="minimal-releases-list">
          <div *ngFor="let release of epkData.releases" class="minimal-release-card">
            <div class="row align-items-center">
              <div class="col-md-3 col-sm-4">
                <div class="minimal-release-cover-wrapper">
                  <img
                    [src]="getCoverArtUrl(release.cover_art_url)"
                    [alt]="release.title + ' Cover Art'"
                    class="minimal-release-cover">
                  <!-- Coming Soon badge for Pending releases (always visible) -->
                  <span *ngIf="release.status === 'Pending'" class="coming-soon-badge">Coming on {{ formatReleaseDate(release.release_date) }}</span>
                  <!-- Play/Pause Button Overlay -->
                  <button
                    *ngIf="isReleasePlayable(release)"
                    class="play-pause-btn minimal"
                    [class.paused]="isReleasePaused(release)"
                    [class.loading]="isReleaseLoading(release)"
                    [disabled]="isReleaseLoading(release)"
                    (click)="togglePlayRelease(release); $event.stopPropagation()"
                    [attr.aria-label]="isReleaseLoading(release) ? 'Loading' : isReleasePlaying(release) ? 'Pause' : isReleasePaused(release) ? 'Resume' : 'Play'">
                    <i *ngIf="!isReleaseLoading(release)" [class]="isReleasePlaying(release) ? 'fas fa-pause' : 'fas fa-play'"></i>
                    <i *ngIf="isReleaseLoading(release)" class="fas fa-spinner fa-spin"></i>
                  </button>
                </div>
              </div>
              <div class="col-md-6 col-sm-8">
                <h3 class="minimal-release-title">{{ release.title }}</h3>
                <p class="minimal-release-date">{{ formatReleaseDate(release.release_date) }}</p>
              </div>
              <div class="col-md-3 col-12">
                <div *ngIf="getStreamingLinks(release).length > 0" class="minimal-streaming-links">
                  <a
                    *ngFor="let link of getStreamingLinks(release)"
                    [href]="link.url"
                    target="_blank"
                    class="minimal-stream-link"
                    [title]="link.name">
                    <i [class]="link.icon"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Gallery Section -->
    <div *ngIf="epkData.gallery.length > 0" class="minimal-section minimal-gallery-section">
      <div class="container">
        <h2 class="minimal-section-title text-center">Gallery</h2>
        <div class="minimal-gallery-grid">
          <div *ngFor="let item of epkData.gallery; let i = index" class="minimal-gallery-item" (click)="openLightbox(i)">
            <img
              [src]="getGalleryImageUrl(item.image_url)"
              [alt]="item.caption || 'Gallery Image'"
              class="minimal-gallery-img">
          </div>
        </div>
      </div>
    </div>

    <!-- Simple Footer -->
    <div class="minimal-footer">
      <div class="container">
        <p class="minimal-footer-text">Powered by Melt Records Dashboard</p>
      </div>
    </div>

  </div>

  <!-- Lightbox Modal -->
  <div *ngIf="lightboxOpen" class="lightbox-overlay" (click)="closeLightbox()">
    <div class="lightbox-container" (click)="$event.stopPropagation()">
      
      <!-- Close Button -->
      <button class="lightbox-close" (click)="closeLightbox()" aria-label="Close lightbox">
        <i class="fas fa-times"></i>
      </button>
      
      <!-- Navigation Arrows -->
      <button 
        *ngIf="galleryImages.length > 1" 
        class="lightbox-nav lightbox-prev" 
        (click)="prevImage()" 
        aria-label="Previous image">
        <i class="fas fa-chevron-left"></i>
      </button>
      
      <button 
        *ngIf="galleryImages.length > 1" 
        class="lightbox-nav lightbox-next" 
        (click)="nextImage()" 
        aria-label="Next image">
        <i class="fas fa-chevron-right"></i>
      </button>
      
      <!-- Image Container -->
      <div class="lightbox-image-container">
        <ng-container *ngIf="getCurrentImage() as currentImage">
          <img 
            [src]="currentImage.url" 
            [alt]="currentImage.caption || 'Gallery Image'"
            class="lightbox-image"
            (load)="onImageLoad($event)">
        </ng-container>
      </div>
      
      <!-- Caption -->
      <ng-container *ngIf="getCurrentImage() as currentImage">
        <div *ngIf="currentImage.caption" class="lightbox-caption">
          {{ currentImage.caption }}
        </div>
      </ng-container>
      
      <!-- Image Counter -->
      <div *ngIf="galleryImages.length > 1" class="lightbox-counter">
        {{ currentImageIndex + 1 }} of {{ galleryImages.length }}
      </div>
      
    </div>
  </div>

</div>