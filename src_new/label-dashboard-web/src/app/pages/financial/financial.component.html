<div class="financial-page">
  <div class="container-fluid">
    <!-- Page Header -->
    <div class="page-header d-flex justify-content-between align-items-center mb-3">
      <h5 class="mb-0">
        <i class="fas fa-dollar-sign me-2 text-primary"></i>
        Financial Management
      </h5>
    </div>
    
    <!-- Main Content -->
    <div class="row" *ngIf="selectedArtist">
      <div class="col-12">
        
        <!-- Tab Navigation -->
        <div class="card tab-navigation">
          <div class="card-header p-0">
            <ul class="nav nav-tabs financial-tabs" role="tablist">
              <li class="nav-item" *ngFor="let tab of tabs" [hidden]="!shouldShowTab(tab)">
                <a class="nav-link" 
                   [class]="getTabClass(tab.id)"
                   (click)="setActiveTab(tab.id)"
                   role="tab">
                  <i class="fa" [class]="tab.icon"></i>
                  {{ tab.label }}
                </a>
              </li>
            </ul>
          </div>
          
          <!-- Tab Content -->
          <div class="card-body tab-content p-0">
            
            <!-- Summary Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'summary'" *ngIf="activeTab === 'summary'">
              <app-financial-summary-tab
                [summary]="summary"
                [latestEarnings]="latestEarnings"
                [latestRoyalties]="latestRoyalties"
                [onPayNow]="onPayNow.bind(this)"
                (viewEarningsDetails)="setActiveTab('earnings')"
                (viewRoyaltiesDetails)="setActiveTab('royalties')"
                (viewPaymentsDetails)="setActiveTab('payments')">
              </app-financial-summary-tab>
            </div>
            
            <!-- Documents Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'documents'" *ngIf="activeTab === 'documents'">
              <app-financial-documents-tab
                [documents]="documents"
                [documentUploadForm]="documentUploadForm"
                [uploadingDocument]="uploadingDocument"
                [onUploadDocument]="onUploadDocument.bind(this)"
                [onDeleteDocument]="onDeleteDocument.bind(this)"
                [onFileSelected]="onFileSelected.bind(this)">
              </app-financial-documents-tab>
            </div>
            
            <!-- Earnings Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'earnings'" *ngIf="activeTab === 'earnings'">
              <app-financial-earnings-tab 
                [earnings]="earnings"
                [pagination]="earningsPagination"
                [loading]="earningsLoading"
                [earningsSort]="earningsSort"
                (pageChange)="onEarningsPageChange($event)"
                (filtersChange)="onEarningsFiltersChange($event)"
                (sortChange)="onEarningsSortChange($event)"
                (dateRangeChange)="onEarningsDateRangeChange($event)"></app-financial-earnings-tab>
            </div>
            
            <!-- Royalties Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'royalties'" *ngIf="activeTab === 'royalties'">
              <app-financial-royalties-tab 
                [royalties]="royalties"
                [pagination]="royaltiesPagination"
                [loading]="royaltiesLoading"
                [royaltiesSort]="royaltiesSort"
                (pageChange)="onRoyaltiesPageChange($event)"
                (filtersChange)="onRoyaltiesFiltersChange($event)"
                (sortChange)="onRoyaltiesSortChange($event)"
                (dateRangeChange)="onRoyaltiesDateRangeChange($event)"></app-financial-royalties-tab>
            </div>
            
            <!-- Payments Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'payments'" *ngIf="activeTab === 'payments'">
              <app-financial-payments-tab
                [payments]="payments"
                [paymentsPagination]="paymentsPagination"
                [paymentsLoading]="paymentsLoading"
                [paymentsSort]="paymentsSort"
                [paymentMethods]="paymentMethods"
                [payoutSettings]="payoutSettings"
                [supportedBanks]="supportedBanks"
                [addPaymentMethodForm]="addPaymentMethodForm"
                [addingPaymentMethod]="addingPaymentMethod"
                [onSubmitPaymentMethod]="onSubmitPaymentMethod.bind(this)"
                [onUpdatePayoutSettings]="onUpdatePayoutSettings.bind(this)"
                [onDeletePaymentMethod]="onDeletePaymentMethod.bind(this)"
                [onSetDefaultPaymentMethod]="onSetDefaultPaymentMethod.bind(this)"
                (paymentsPageChange)="onPaymentsPageChange($event)"
                (paymentsFiltersChange)="onPaymentsFiltersChange($event)"
                (paymentsSortChange)="onPaymentsSortChange($event)">
              </app-financial-payments-tab>
            </div>
            
            <!-- Release Information Tab -->
            <div class="tab-pane" [class.active]="activeTab === 'release'" *ngIf="activeTab === 'release'">
              <app-financial-release-tab
                [releases]="releases"
                [isAdmin]="isAdmin"
                [editingRoyalties]="editingRoyalties"
                [updatingRoyalties]="updatingRoyalties"
                [toggleEditRoyalties]="toggleEditRoyalties.bind(this)"
                [onUpdateRoyalties]="onUpdateRoyalties.bind(this)"
                [onAddExpense]="onAddExpense.bind(this)">
              </app-financial-release-tab>
            </div>

            <!-- Admin-only tabs -->
            <div class="tab-pane" [class.active]="activeTab === 'new-royalty'" *ngIf="activeTab === 'new-royalty' && isAdmin">
              <app-new-royalty-form
                [newRoyaltyForm]="newRoyaltyForm"
                [releases]="releases"
                [onSubmitRoyalty]="onSubmitRoyalty.bind(this)">
              </app-new-royalty-form>
            </div>

            <div class="tab-pane" [class.active]="activeTab === 'new-payment'" *ngIf="activeTab === 'new-payment' && isAdmin">
              <app-new-payment-form
                #newPaymentFormComponent
                [newPaymentForm]="newPaymentForm"
                [paymentMethods]="paymentMethods"
                [walletBalance]="walletBalance"
                [isSubmittingPayment]="submittingPayment"
                [onSubmitPayment]="onSubmitPayment.bind(this)">
              </app-new-payment-form>
            </div>

            <div class="tab-pane" [class.active]="activeTab === 'new-earning'" *ngIf="activeTab === 'new-earning' && isAdmin">
              <app-new-earning-form
                [newEarningForm]="newEarningForm"
                [releases]="releases"
                [onSubmitEarning]="onSubmitEarning.bind(this)">
              </app-new-earning-form>
            </div>
            
          </div>
        </div>
        
      </div>
    </div>
    
    <!-- No Artist Selected -->
    <div class="row" *ngIf="!selectedArtist">
      <div class="col-12">
        <div class="card">
          <div class="card-body text-center p-5">
            <i class="fas fa-money-bill fa-4x text-muted mb-3"></i>
            <h4>No Artist Selected</h4>
            <p class="text-muted">Please select an artist from the dropdown above to view financial information.</p>
          </div>
        </div>
      </div>
    </div>
    
  </div>
</div>
