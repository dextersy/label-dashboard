<div class="financial-page">
  <div class="container-fluid">
    <!-- Page Header -->
    <div class="page-header mb-3">
      <app-breadcrumb></app-breadcrumb>
    </div>
    
    <!-- Main Content -->
    <div class="row" *ngIf="selectedArtist">
      <div class="col-12">
        
        <!-- Tab Content (no navigation needed, handled by sidebar) -->
        <!-- Summary Tab -->
        <div *ngIf="activeTab === 'summary'">
          <app-financial-summary-tab
            [summary]="summary"
            [latestEarnings]="latestEarnings"
            [latestRoyalties]="latestRoyalties"
            [onPayNow]="onPayNow.bind(this)"
            (viewEarningsDetails)="setActiveTab('earnings')"
            (viewRoyaltiesDetails)="setActiveTab('royalties')"
            (viewPaymentsDetails)="setActiveTab('payments')">
          </app-financial-summary-tab>
        </div>
        
        <!-- Documents Tab -->
        <div *ngIf="activeTab === 'documents'">
          <app-financial-documents-tab
            [documents]="documents"
            [documentUploadForm]="documentUploadForm"
            [uploadingDocument]="uploadingDocument"
            [onUploadDocument]="onUploadDocument.bind(this)"
            [onDeleteDocument]="onDeleteDocument.bind(this)"
            [onFileSelected]="onFileSelected.bind(this)">
          </app-financial-documents-tab>
        </div>
        
        <!-- Earnings Tab -->
        <div *ngIf="activeTab === 'earnings'">
          <app-financial-earnings-tab 
            [earnings]="earnings"
            [pagination]="earningsPagination"
            [loading]="earningsLoading"
            [earningsSort]="earningsSort"
            [currentFilters]="earningsFilters"
            [currentDateRange]="earningsDateRange"
            (pageChange)="onEarningsPageChange($event)"
            (filtersChange)="onEarningsFiltersChange($event)"
            (sortChange)="onEarningsSortChange($event)"
            (dateRangeChange)="onEarningsDateRangeChange($event)"></app-financial-earnings-tab>
        </div>
        
        <!-- Royalties Tab -->
        <div *ngIf="activeTab === 'royalties'">
          <app-financial-royalties-tab 
            [royalties]="royalties"
            [pagination]="royaltiesPagination"
            [loading]="royaltiesLoading"
            [royaltiesSort]="royaltiesSort"
            [currentFilters]="royaltiesFilters"
            [currentDateRange]="royaltiesDateRange"
            (pageChange)="onRoyaltiesPageChange($event)"
            (filtersChange)="onRoyaltiesFiltersChange($event)"
            (sortChange)="onRoyaltiesSortChange($event)"
            (dateRangeChange)="onRoyaltiesDateRangeChange($event)"></app-financial-royalties-tab>
        </div>
        
        <!-- Payments Tab -->
        <div *ngIf="activeTab === 'payments'">
          <app-financial-payments-tab
            [payments]="payments"
            [paymentsPagination]="paymentsPagination"
            [paymentsLoading]="paymentsLoading"
            [paymentsSort]="paymentsSort"
            [paymentMethods]="paymentMethods"
            [payoutSettings]="payoutSettings"
            [supportedBanks]="supportedBanks"
            [addPaymentMethodForm]="addPaymentMethodForm"
            [addingPaymentMethod]="addingPaymentMethod"
            [onSubmitPaymentMethod]="onSubmitPaymentMethod.bind(this)"
            [onUpdatePayoutSettings]="onUpdatePayoutSettings.bind(this)"
            [onDeletePaymentMethod]="onDeletePaymentMethod.bind(this)"
            [onSetDefaultPaymentMethod]="onSetDefaultPaymentMethod.bind(this)"
            (paymentsPageChange)="onPaymentsPageChange($event)"
            (paymentsFiltersChange)="onPaymentsFiltersChange($event)"
            (paymentsSortChange)="onPaymentsSortChange($event)">
          </app-financial-payments-tab>
        </div>
        
        <!-- Release Information Tab -->
        <div *ngIf="activeTab === 'release'">
          <app-financial-release-tab
            [releases]="releases"
            [isAdmin]="isAdmin"
            [editingRoyalties]="editingRoyalties"
            [updatingRoyalties]="updatingRoyalties"
            [toggleEditRoyalties]="toggleEditRoyalties.bind(this)"
            [onUpdateRoyalties]="onUpdateRoyalties.bind(this)"
            [onAddExpense]="onAddExpense.bind(this)">
          </app-financial-release-tab>
        </div>

        <!-- New Royalty Tab -->
        <div *ngIf="activeTab === 'new-royalty' && isAdmin">
          <app-new-royalty-form
            [newRoyaltyForm]="newRoyaltyForm"
            [releases]="releases"
            [onSubmitRoyalty]="onSubmitRoyalty.bind(this)">
          </app-new-royalty-form>
        </div>

        <!-- New Payment Tab -->
        <div *ngIf="activeTab === 'new-payment' && isAdmin">
          <app-new-payment-form
            #newPaymentFormComponent
            [newPaymentForm]="newPaymentForm"
            [paymentMethods]="paymentMethods"
            [walletBalance]="walletBalance"
            [isSubmittingPayment]="submittingPayment"
            [onSubmitPayment]="onSubmitPayment.bind(this)">
          </app-new-payment-form>
        </div>

        <!-- New Earning Tab -->
        <div *ngIf="activeTab === 'new-earning' && isAdmin">
          <app-new-earning-form
            [newEarningForm]="newEarningForm"
            [releases]="releases"
            [onSubmitEarning]="onSubmitEarning.bind(this)">
          </app-new-earning-form>
        </div>
      </div>
    </div>
    
    <!-- No Artist Selected -->
    <div class="row" *ngIf="!selectedArtist">
      <div class="col-12">
        <div class="card">
          <div class="card-body text-center p-5">
            <i class="fas fa-money-bill fa-4x text-muted mb-3"></i>
            <h4>No Artist Selected</h4>
            <p class="text-muted">Please select an artist from the dropdown above to view financial information.</p>
          </div>
        </div>
      </div>
    </div>
    
  </div>
</div>
