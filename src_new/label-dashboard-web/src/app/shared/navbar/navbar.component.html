<nav class="navbar navbar-expand-lg navbar-light fixed" [style.background]="navbarBg">
  <div class="container-fluid">
    <!-- Burger and Context Icons Container -->
    <div class="navbar-left-group">
      <button class="navbar-toggle" type="button" (click)="toggleSidebar()" aria-label="Toggle navigation">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <!-- Brand Logo -->
      <a [href]="brandWebsite" class="navbar-brand-logo" *ngIf="brandLogo">
        <img [src]="brandLogo" alt="Brand Logo" class="navbar-logo-img">
      </a>

      <!-- Context Icons (Artist) - visible on mobile -->
      <div class="navbar-context-icons">
        <!-- Artist icon - shown when on artist/music/financial routes -->
        <div class="context-icon" *ngIf="shouldShowArtistSelection() && selectedArtist" (click)="toggleSidebar()">
          <img [src]="getArtistProfilePhoto()" [alt]="selectedArtist.name" class="context-avatar">
        </div>
      </div>
    </div>

    <!-- Workspace Selector (only show if user has multiple workspaces) -->
    <div class="navbar-workspace-selector" *ngIf="availableWorkspaces.length > 1">
      <div class="workspace-tabs">
        <button
          *ngFor="let workspace of availableWorkspaces"
          class="workspace-tab"
          [class]="'workspace-tab-' + workspace"
          [class.active]="currentWorkspace === workspace"
          (click)="selectWorkspace(workspace)">
          <i [class]="getWorkspaceIcon(workspace)"></i>
          <span class="workspace-label">{{ getWorkspaceLabel(workspace) }}</span>
        </button>
      </div>
    </div>

    <!-- User menu (rightmost) -->
    <div class="user-menu" [class.open]="userDropdownOpen">
      <button class="user-menu-trigger" (click)="toggleUserDropdown()">
        <i class="fa-solid fa-user"></i>
        <span class="user-name">Welcome, <strong>{{ userFirstName }}</strong>!</span>
        <span *ngIf="isSuperadmin" class="superadmin-chip">
          <i class="fa-solid fa-crown"></i> Superadmin
        </span>
        <span *ngIf="isAdmin && !isSuperadmin" class="admin-chip">
          <i class="fa-solid fa-shield"></i> Admin
        </span>
        <i class="fa-solid fa-chevron-down user-menu-arrow"></i>
      </button>

      <div class="user-dropdown-menu" *ngIf="userDropdownOpen">
        <div class="user-dropdown-header">
          <span class="user-dropdown-welcome">Welcome, <strong>{{ userFirstName }}</strong>!</span>
          <span *ngIf="isSuperadmin" class="superadmin-chip">
            <i class="fa-solid fa-crown"></i> Superadmin
          </span>
          <span *ngIf="isAdmin && !isSuperadmin" class="admin-chip">
            <i class="fa-solid fa-shield"></i> Admin
          </span>
        </div>
        <a *ngIf="isAdmin" class="user-dropdown-item" (click)="selectWorkspace('admin'); closeUserDropdown()" style="cursor: pointer;">
          <i class="fas fa-cogs"></i> Administration
        </a>
        <a class="user-dropdown-item" routerLink="/profile" (click)="closeUserDropdown()">
          <i class="fa-solid fa-user"></i> Edit profile
        </a>
        <a class="user-dropdown-item" (click)="logout(); closeUserDropdown()" style="cursor: pointer;">
          <i class="fa-solid fa-right-from-bracket"></i> Log out
        </a>
      </div>
    </div>

    <!-- Backdrop to close user dropdown -->
    <div class="user-menu-backdrop" *ngIf="userDropdownOpen" (click)="closeUserDropdown()"></div>
  </div>
</nav>

<!-- Mobile Bottom Workspace Navigation (only show if user has multiple workspaces) -->
<div class="mobile-bottom-nav" *ngIf="availableWorkspaces.length > 1">
  <button
    *ngFor="let workspace of availableWorkspaces"
    class="mobile-workspace-btn"
    [class]="'mobile-workspace-btn-' + workspace"
    [class.active]="currentWorkspace === workspace"
    (click)="selectWorkspace(workspace)">
    <i [class]="getWorkspaceIcon(workspace)"></i>
    <span class="mobile-workspace-label">{{ getWorkspaceLabel(workspace) }}</span>
  </button>
  <!-- Blank spacer to prevent chat widget overlap -->
  <div class="mobile-workspace-spacer"></div>
</div>
